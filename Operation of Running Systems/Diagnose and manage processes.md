# Diagnose and manage processes

- Linux provides us a utility called ps for viewing information related with the processes on a system which stands as abbreviation for “Process Status”. ps command is used to list the currently running processes and their PIDs along with some other information depends on different options. It reads the process information from the virtual files in /proc file-system. /proc contains virtual files, this is the reason it’s referred as a virtual file system.  

- Simple process selection : Shows the processes for the current shell 

```
[root@rhel7 ~]# ps
  PID TTY          TIME CMD
12330 pts/0    00:00:00 bash
21621 pts/0    00:00:00 ps
```

- To see every process on the system using BSD syntax  
```
ps ax
ps aux # u mean user oriented format
```

- To Search process with specific user
```
ps u -U user
```
- Search for process with specific name
```
pgrep -a syslog
```
- process niceness lies between -20 to 20(only root can set negative value)
```
ps lax # show nice vale NI column
nice -n 11 bash
```
- To see which process is parent of process tree structure
```
ps faux
```
- A signal is an event generated by the UNIX and Linux systems in response to some condition. Upon receipt of a signal, a process may take action  

- Use the kill -l command to list all available signals.

    -The most commonly used signals are:

        - 1 (HUP): to reload a process.
        - 9 (KILL): to kill a process.
        - 15 (TERM): to gracefully stop a process.

- The main difference between these tools is that kill terminates processes based on Process ID number (PID), while the killall and pkill commands terminate running processes based on their names and other attributes.  
```
kill -L
sudo kill -SIGHUP 1147 
#if prcocess running under root use sudo
kill 1752 # SIGTERM Is default event which is gracefull termination
```
- Detect a process grep and terminate process
```
pgrep -a bash
pkill -KILL bash
```
- process in background mode
```
sleep 300 &
# backup in background 
jobs 
# To see jobs running in background
```
- To see which directory process is using
```
lsof -p 8401
sudo lsof /var/log/messages
```

## Q&A

- Assign a nice value of 9 to the sshd process.
```
ps aux
sudo renice -n 9 <PID>
```
- List all files that are opened by process with PID 1, this process is owned by the root user.
Save the output in /home/bob/files.txt file.
```
sudo lsof -p 1 > /home/bob/files.txt
```
- Identify the PID of the process named rpcbind and save its value in /home/bob/pid.txt file.
```
pgrep -a rpcbind
pgrep rpcbind > /home/bob/pid.txt
```
- With the systemctl command, find out the PID of the process currently managed by the sshd.service. Send the SIGHUP signal to this process.
```
systemctl status sshd.service
sudo kill -SIGHUP <pid>
```
- Using ps command, identify the CPU and Memory usage by only the process having PID 1 and save the entire command output in /home/bob/resources.txt file.
```
ps u 1 > /home/bob/resources.txt
```
- Run a command to sleep for 3000 seconds and make sure its running in the background.
```
sleep 3000 &
jobs
```